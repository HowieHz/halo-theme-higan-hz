import"./common-CB2peu2R.js";var e=class{constructor(e){this.$el=e.$el||null,this.columns=e.columns||4,this.gap=e.gap||10,this.width=0,this.items=[],this.nextImageIndex=0,this.totalImages=0,this.H=[],this.flag=null,this.init()}init(){if(this.$el)this.addChildren(Array.from(this.$el.children));else throw Error(`Parent container element not found`)}addChildren(e){if(!Array.isArray(e))throw Error(`Children should be an array`);e.forEach(e=>{this.items.includes(e)||(this.$el.appendChild(e),this.items.push(e),this.totalImages++)}),this.reset(),this.render()}reset(){this.flag=document.createDocumentFragment(),this.width=this.$el.clientWidth/this.columns,this.H=Array(this.columns).fill(0),this.$el.innerHTML=``}render(){let{width:e,items:t,flag:n,H:r,gap:i}=this;t.forEach(t=>{t.style.width=`${e}px`,t.style.position=`absolute`;let a=t.querySelector(`img`);if(a){let o=()=>{t.style.opacity=0,this.placeItem(t,a,r,e,i,n),this.updateContainerHeight(),this.checkAndLoadMoreImages(),requestAnimationFrame(()=>{t.style.transition="opacity [(${theme.config?.photos_styles?.img_transition_duration_after_load})]s",t.style.opacity=1})};a.complete?o():a.addEventListener(`load`,o)}})}placeItem(e,t,n,r,i,a){let o=n.indexOf(Math.min(...n));e.style.left=`${o*(r+i)}px`,e.style.top=`${n[o]}px`,n[o]+=t.height*r/t.width+i,a.appendChild(e),this.$el.append(a)}getMaxHeight(){return Math.max(...this.H)}updateContainerHeight(){let e=this.getMaxHeight();this.$el.style.height=`${e}px`}checkAndLoadMoreImages(){var{nextImageIndex:e,totalImages:t}=this;if(window.scrollY+window.innerHeight+200>=this.getMaxHeight()&&this.nextImageIndex<this.totalImages){let e=this.items[this.nextImageIndex].querySelector(`img`);e.style.display=`block`,e.loading=`eager`,this.nextImageIndex++}}};window.onload=()=>{let t=4,n=1,r=300;function i(){let e=window.innerWidth,i=Math.floor(e/r);return Math.max(n,Math.min(i,t))}let a=new e({$el:document.querySelector(`.photo-list`),columns:i(),gap:10});window.addEventListener(`resize`,()=>{let e=i();e!==a.columns&&(a.columns=e,a.reset(),a.render())}),window.addEventListener(`scroll`,()=>a.checkAndLoadMoreImages()),window.addEventListener(`resize`,()=>a.checkAndLoadMoreImages()),a.checkAndLoadMoreImages()};const t=document.querySelectorAll(`.photo-groups img`);var n=0,r=t.length,i=0;t.forEach(e=>{let t=()=>{a(),requestAnimationFrame(()=>{e.style.transition="opacity [(${theme.config?.photos_styles?.img_transition_duration_after_load})]s",e.style.opacity=1})};e.complete?t():e.addEventListener(`load`,t)});function a(){if(window.scrollY+window.innerHeight+200>=i&&n<r){let e=t[n];e.style.display=`block`,e.loading=`eager`,i=e.getBoundingClientRect().bottom,n++}}window.addEventListener(`scroll`,()=>a()),window.addEventListener(`resize`,()=>a()),a();